>从表中删除数据的方式，及区别(TRUNCATE和DELETE 其他)


|TRUNCATE |DELETE|
| ---- | ---- |
| 从表中删除所有记录。我们不能使用WHERE删除特定的记录 | 删除所有记录，并可以使用WHERE删除特定记录。|
|不触发DELETE触发器。|触发DELETE触发器
|重置标识列|不重置标识列
|由于日志很少，所以速度更快。|由于执行了表扫描，以计算要删除的行数，并逐个删除行，所以会更慢。更改被记录在事务日志中。
|使用行级锁|使用表级锁
|需要ALTER TABLE权限|需要表的DELETE 权限

-->延伸问题 sql server 用户权限

-->延伸问题 数据查询慢

索引问题？是否命中索引，查看执行计划，判断耗时的地方，是否命中索引，如果查询条件不在聚集索引中，是否可以添加非聚集索引来基金耗时问题

锁问题？是否查询的地方会经常更新

宽带问题？

-->延伸问题 执行计划的优缺点

-->延伸问题 数据库锁

-->延伸问题 存在则插入，否则更新

mysql中有相应的语句进行操作

sql server中没有相关语句，可以以下方式解决

* 触发器

触发器进行操作，这样不受后台影响，后台可以使用ef等框架直接进行插入操作

* 更改数据库设计

如果存在频繁的插入操作，又需要判断是否存在的情况，这时候可能是数据库设计不当，是否能设计为不判断是否存在的情况，类似MongoDB

* sql语句

使用sql语句来进行操作，sql语句中加上事务，事务开始，更新数据行，如果更新数量为0，说明不存在，则插入，事务关闭。
这个适应于单条数据插入的情况下，先进行数据更新操作，那就减少了一次判断数据存在的判断，减少一次索引查询，通过数据更新量来判断数据是否存在。

* union all

批量插入时，如果要判断是否存在，可以使用join操作。

事务开始，通过union all来拼接sql进行批量插入，join判断是否存在，不存在就插入。

mysql中也类似，使用MERGE进行操作

## 数据库登录名/用户/角色/架构

数据库的用户和角色，以及各种权限的意思